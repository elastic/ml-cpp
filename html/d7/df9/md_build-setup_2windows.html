<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ML C++: Machine Learning Build Machine Setup for Windows</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript" src="../../darkmode_toggle.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../ml.ico"/></td>
  <td id="projectalign">
   <div id="projectname">ML C++<span id="projectnumber">&#160;8.15.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Machine Learning Build Machine Setup for Windows</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#autotoc_md52">Operating system</a></li>
<li class="level2"><a href="#autotoc_md53">Windows 8 SDK</a></li>
<li class="level2"><a href="#autotoc_md54">Microsoft Visual Studio 2019 Professional</a></li>
<li class="level2"><a href="#autotoc_md55">Git for Windows</a></li>
<li class="level2"><a href="#autotoc_md56">CMake</a></li>
<li class="level2"><a href="#autotoc_md57">zlib</a></li>
<li class="level2"><a href="#autotoc_md58">libxml2</a></li>
<li class="level2"><a href="#autotoc_md59">Boost 1.83.0</a></li>
<li class="level2"><a href="#autotoc_md60">strptime</a></li>
<li class="level2"><a href="#autotoc_md61">Python 3.10</a></li>
<li class="level2"><a href="#autotoc_md62">PyTorch 2.1.2</a></li>
</ul>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md51"></a></p>
<p>These instructions are for setting up a Windows build machine from scratch.</p>
<p>For subsequent machines, the setup can be simplified by copying components from the first machine - see <a class="el" href="../../d8/ded/md_build-setup_2windows__simple.html">windows_simple.md</a>.</p>
<p>On Windows, the build system runs within Git for Windows. This provides a bash shell that enables our Unix build system to work on Windows without alteration.</p>
<p>The build system assumes Windows itself is installed on the <code>C:</code> drive. If this is not the case on your machine, set the <code>ROOT</code> environment variable to the appropriate drive.</p>
<p>If you use Gradle to build Machine Learning you do not need to work in Git Bash, as Gradle tasks will run it when necessary. In order to develop interactively on Windows, you must work in Git Bash. You will need the following environment variables to be defined:</p>
<ul>
<li><code>CPP_SRC_HOME</code> - This must contain the absolute path of the top level source code directory.</li>
</ul>
<p>You will also need to add several directories to your <code>PATH</code> environment variable. These need to be in the MinGW format, i.e. beginning with /drive letter/ followed by the directory path using forward slashes instead of backslashes, and with no spaces in the directory names. Where a Windows directory name contains a space, you must use the 8.3 version of that directory name (which you can find using <code>dir /x</code> at a command prompt). The directories that need to be added are:</p>
<ul>
<li><code>/c/PROGRA~2/MICROS~2/2019/Professional/VC/Tools/MSVC/14.23.28105/bin/Hostx64/x64</code></li>
<li><code>/c/PROGRA~2/MICROS~2/2019/Professional/Common7/IDE</code></li>
<li><code>/c/PROGRA~2/WI3CF2~1/8.0/bin/x64</code></li>
<li><code>/c/PROGRA~2/WI3CF2~1/8.0/bin/x86</code></li>
<li><code>/c/PROGRA~2/MICROS~2/2019/Professional/TEAMTO~1/PERFOR~1/x64</code></li>
<li><code>/c/PROGRA~2/MICROS~2/2019/Professional/TEAMTO~1/PERFOR~1</code></li>
<li><code>/c/PROGRA~1/Java/jdk1.8.0_121/bin</code></li>
<li><code>/c/PROGRA~1/CMake/bin</code></li>
<li><code>/c/usr/local/bin</code></li>
<li><code>/c/usr/local/lib</code></li>
</ul>
<p>For example, you might create a <code>.bashrc</code> file in your home directory containing this:</p>
<div class="fragment"><div class="line">export CPP_SRC_HOME=$HOME/ml-cpp</div>
<div class="line">VCVER=`/bin/ls -1 /c/PROGRA~2/MICROS~2/2019/Professional/VC/Tools/MSVC | tail -1`</div>
<div class="line">VCBINDIR=/c/PROGRA~2/MICROS~2/2019/Professional/VC/Tools/MSVC/$VCVER/bin/Hostx64/x64:/c/PROGRA~2/MICROS~2/2019/Professional/Common7/IDE:/c/PROGRA~2/WI3CF2~1/8.0/bin/x64:/c/PROGRA~2/WI3CF2~1/8.0/bin/x86:/c/PROGRA~2/MICROS~2/2019/Professional/TEAMTO~1/PERFOR~1/x64:/c/PROGRA~2/MICROS~2/2019/Professional/TEAMTO~1/PERFOR~1</div>
<div class="line">export JAVA_HOME=/c/PROGRA~1/Java/jdk1.8.0_121</div>
<div class="line">export PATH=&quot;$CPP_SRC_HOME/build/distribution/platform/windows-x86_64/bin:$VCBINDIR:/mingw64/bin:$JAVA_HOME/bin:/c/usr/local/bin:/c/usr/local/lib:/bin:/c/Windows/System32:/c/Windows:/c/PROGRA~1/CMake/bin&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md52"></a>
Operating system</h2>
<p>64 bit Windows is required.</p>
<p>It is possible to build on Windows Server 2012r2, Windows Server 2016 and Windows 10. Other versions may encounter problems.</p>
<h2><a class="anchor" id="autotoc_md53"></a>
Windows 8 SDK</h2>
<p>Download <code>sdksetup.exe</code> from <a href="https://developer.microsoft.com/en-us/windows/downloads/windows-8-sdk">https://developer.microsoft.com/en-us/windows/downloads/windows-8-sdk</a> and run it. Accept the default installation location, opt out of the customer experience improvement program and accept the license agreement. Then install with all features selected.</p>
<h2><a class="anchor" id="autotoc_md54"></a>
Microsoft Visual Studio 2019 Professional</h2>
<p><em>Make sure you install the Windows 8 SDK before this, as it cannot be installed afterwards.</em></p>
<p>The Professional edition requires an MSDN subscription. Download the installer, <code>vs_professional__904165217.1561988349.exe</code>, from <a href="https://my.visualstudio.com/downloads">https://my.visualstudio.com/downloads</a>, and run it.</p>
<p>On the "Workloads" page that is displayed after a short while, check "Desktop development with C++". Then click on the "Individual Components" tab and check "Windows Universal CRT SDK" (about half way down the list). Then click "Install".</p>
<h2><a class="anchor" id="autotoc_md55"></a>
Git for Windows</h2>
<p>Download <code>Git-2.42.0.2-64-bit.exe</code> from <a href="https://github.com/git-for-windows/git/releases/download/v2.42.0.windows.2/Git-2.42.0.2-64-bit.exe">https://github.com/git-for-windows/git/releases/download/v2.42.0.windows.2/Git-2.42.0.2-64-bit.exe</a>.</p>
<p>Install it using mainly the default options suggested by the installer, but on the feature selection dialog also check "On the desktop" in the "Additional icons" section.</p>
<p>Do not change the suggested default autocrlf setting (true), as Unix line endings do not work for unit test test files.</p>
<p>As well as providing a Git implementation, Git for Windows comes with Windows ports of a variety of common Unix commands, e.g. <code>grep</code>, <code>sed</code>, <code>awk</code>, <code>find</code>, and many others.</p>
<h2><a class="anchor" id="autotoc_md56"></a>
CMake</h2>
<p>CMake version 3.19.2 is the minimum required to build ml-cpp. Download the MSI installer for version 3.23.3 from <a href="https://github.com/Kitware/CMake/releases/download/v3.23.3/cmake-3.23.3-windows-x86_64.msi">https://github.com/Kitware/CMake/releases/download/v3.23.3/cmake-3.23.3-windows-x86_64.msi</a> (or get a more recent version).</p>
<p>Install it mainly using the default options <em>except</em> on the "Install Options" dialog check "Add CMake to the system PATH for all users".</p>
<h2><a class="anchor" id="autotoc_md57"></a>
zlib</h2>
<p>Whilst it is possible to download a pre-built version of <code>zlib1.dll</code>, for consistency we want one that links against the Visual Studio 2019 C runtime library. Therefore it is necessary to build zlib from source.</p>
<p>Download the source code from <a href="http://zlib.net/">http://zlib.net/</a> - the file is called <code>zlib1213.zip</code>. Unzip this file under <code>C:\tools</code>, so that you end up with a directory called <code>C:\tools\zlib-1.2.13</code>.</p>
<p>To build, start a command prompt using Start Menu -&gt; Apps -&gt; Visual Studio 2019 -&gt; x64 Native Tools Command Prompt for VS 2019, then in it type:</p>
<div class="fragment"><div class="line">cd \tools\zlib-1.2.13</div>
<div class="line">nmake -f win32/Makefile.msc LOC=&quot;-D_WIN32_WINNT=0x0601&quot;</div>
<div class="line">nmake -f win32/Makefile.msc test</div>
</div><!-- fragment --><p>All the build output will end up in the top level <code>C:\tools\zlib-1.2.13</code> directory. Once the build is complete, copy <code>zlib1.dll</code> and <code>minigzip.exe</code> to <code>C:\usr\local\bin</code>. Copy <code>zlib.lib</code> and <code>zdll.lib</code> to <code>C:\usr\local\lib</code>. And copy <code>zlib.h</code> and <code>zconf.h</code> to <code>C:\usr\local\include</code>.</p>
<h2><a class="anchor" id="autotoc_md58"></a>
libxml2</h2>
<p>Download <code>libxml2-2.9.14.tar.xz</code> from <a href="https://download.gnome.org/sources/libxml2/2.9/libxml2-2.9.14.tar.xz">https://download.gnome.org/sources/libxml2/2.9/libxml2-2.9.14.tar.xz</a>.</p>
<p>Extract it in a Git bash shell using the GNU tar that comes with Git for Windows, e.g.:</p>
<div class="fragment"><div class="line">cd /c/tools</div>
<div class="line">tar Jxvf /z/cpp_src/libxml2-2.9.14.tar.xz</div>
</div><!-- fragment --><p>Edit <code>C:\tools\libxml2-2.9.14\win32\Makefile.msvc</code> and change the following lines:</p>
<div class="fragment"><div class="line">CFLAGS = $(CFLAGS) /D &quot;NDEBUG&quot; /O2</div>
</div><!-- fragment --><p>to:</p>
<div class="fragment"><div class="line">CFLAGS = $(CFLAGS) /D &quot;NDEBUG&quot; /O2 /Zi /D_WIN32_WINNT=0x0601</div>
</div><!-- fragment --><p>(because we might as well generate a PDB file and we want to limit Windows API functions to those that exist in Windows Server 2008r2).</p>
<p>Start a command prompt using Start Menu -&gt; Apps -&gt; Visual Studio 2019 -&gt; x64 Native Tools Command Prompt for VS 2019, then in it type:</p>
<div class="fragment"><div class="line">cd \tools\libxml2-2.9.14\win32</div>
<div class="line">cscript configure.js iconv=no prefix=C:\usr\local</div>
<div class="line">nmake</div>
<div class="line">nmake install</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md59"></a>
Boost 1.83.0</h2>
<p>Download version 1.83.0 of Boost from <a href="https://boostorg.jfrog.io/artifactory/main/release/1.83.0/source/boost_1_83_0.tar.bz2">https://boostorg.jfrog.io/artifactory/main/release/1.83.0/source/boost_1_83_0.tar.bz2</a> . You must get this exact version, as the Machine Learning build system requires it.</p>
<p>Assuming you chose the <code>.bz2</code> version, extract it in a Git bash shell using the GNU tar that comes with Git for Windows, e.g.:</p>
<div class="fragment"><div class="line">cd /c/tools</div>
<div class="line">tar jxvf /z/cpp_src/boost_1_83_0.tar.bz2</div>
</div><!-- fragment --><p>Edit <code>boost/unordered/detail/prime_fmod.hpp</code> and change line 134 from:</p>
<div class="fragment"><div class="line">(13ul)(29ul)(53ul)(97ul)(193ul)(389ul)(769ul)(1543ul)(3079ul)(6151ul)(       \</div>
</div><!-- fragment --><p>to:</p>
<div class="fragment"><div class="line">(3ul)(13ul)(29ul)(53ul)(97ul)(193ul)(389ul)(769ul)(1543ul)(3079ul)(6151ul)(       \</div>
</div><!-- fragment --><p>Start a command prompt using Start Menu -&gt; Apps -&gt; Visual Studio 2019 -&gt; x64 Native Tools Command Prompt for VS 2019, then in it type:</p>
<div class="fragment"><div class="line">cd \tools\boost_1_83_0</div>
<div class="line">bootstrap.bat</div>
<div class="line">b2 -j6 --layout=versioned --disable-icu --toolset=msvc-14.2 cxxflags=&quot;-std:c++17&quot; linkflags=&quot;-std:c++17&quot; --build-type=complete -sZLIB_INCLUDE=&quot;C:\tools\zlib-1.2.13&quot; -sZLIB_LIBPATH=&quot;C:\tools\zlib-1.2.13&quot; -sZLIB_NAME=zdll --without-context --without-coroutine --without-graph_parallel --without-mpi --without-python architecture=x86 address-model=64 optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS define=BOOST_LOG_WITHOUT_DEBUG_OUTPUT define=BOOST_LOG_WITHOUT_EVENT_LOG define=BOOST_LOG_WITHOUT_SYSLOG define=BOOST_LOG_WITHOUT_IPC define=_WIN32_WINNT=0x0601</div>
<div class="line">b2 install --prefix=C:\usr\local --layout=versioned --disable-icu --toolset=msvc-14.2 cxxflags=&quot;-std:c++17&quot; linkflags=&quot;-std:c++17&quot; --build-type=complete -sZLIB_INCLUDE=&quot;C:\tools\zlib-1.2.13&quot; -sZLIB_LIBPATH=&quot;C:\tools\zlib-1.2.13&quot; -sZLIB_NAME=zdll --without-context --without-coroutine --without-graph_parallel --without-mpi --without-python architecture=x86 address-model=64 optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS define=BOOST_LOG_WITHOUT_DEBUG_OUTPUT define=BOOST_LOG_WITHOUT_EVENT_LOG define=BOOST_LOG_WITHOUT_SYSLOG define=BOOST_LOG_WITHOUT_IPC define=_WIN32_WINNT=0x0601</div>
</div><!-- fragment --><p>The Boost headers and appropriate libraries should end up in <code>C:\usr\local\include</code> and <code>C:\usr\local\lib</code> respectively.</p>
<h2><a class="anchor" id="autotoc_md60"></a>
strptime</h2>
<p>Visual Studio's C runtime library has a <code>strftime()</code> function but no <code><a class="el" href="../../d3/d7e/_c_str_p_time___windows_8cc.html#ac61ca60914adeb92f5db18c9dabf7b4f">strptime()</a></code> function, and unfortunately it's needed for our date handling functionality.</p>
<p>There is an open source <code><a class="el" href="../../d3/d7e/_c_str_p_time___windows_8cc.html#ac61ca60914adeb92f5db18c9dabf7b4f">strptime()</a></code> implementation from NetBSD. It needs some hacking about to get it to compile on Windows, but this is not an insurmountable challenge. Download <code>strptime.c</code> and <code><a class="el" href="../../d3/d2e/private_8h.html">private.h</a></code> from <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/time/strptime.c?rev=HEAD">http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/time/strptime.c?rev=HEAD</a> and <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/time/private.h?rev=HEAD">http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/time/private.h?rev=HEAD</a> respectively. These files are also checked in in the <code>strptime</code> sub-directory of the directory containing these instructions, as are some patch files that modify the original files so that they'll compile on Windows.</p>
<p>In a Git bash shell, copy the original source files and patches to a temporary directory and apply the patches, e.g.:</p>
<div class="fragment"><div class="line">cp -r strptime /c/tools</div>
<div class="line">cd /c/tools/strptime</div>
<div class="line">patch -i strptime.ucrt.patch</div>
<div class="line">patch -i private.patch</div>
</div><!-- fragment --><p>Start a command prompt using Start Menu -&gt; Apps -&gt; Visual Studio 2019 -&gt; x64 Native Tools Command Prompt for VS 2019, then in it type:</p>
<div class="fragment"><div class="line">cd C:\tools\strptime</div>
<div class="line">cl -c -nologo -O2 -MD -DWIN32_LEAN_AND_MEAN -D_WIN32_WINNT=0x0601 -DNDEBUG strptime.c</div>
<div class="line">lib -NOLOGO strptime.obj</div>
<div class="line">copy strptime.lib C:\usr\local\lib</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md61"></a>
Python 3.10</h2>
<p>PyTorch currently requires Python 3.7 or higher; we use version 3.10.</p>
<p>Download the executable installer for Python 3.10.9 from <a href="https://www.python.org/ftp/python/3.10.9/python-3.10.9-amd64.exe">https://www.python.org/ftp/python/3.10.9/python-3.10.9-amd64.exe</a>.</p>
<p>Right click on the installer and "Run as administrator". (Note that evelating privileges during the install is not sufficient for the Python 3.10.9 installer, it needs to have elevated privileges when first run. Obviously this is bad practice, but that's the way it is in version 3.10.9.)</p>
<p>On the first installer screen click "Customize installation". (Although "Install Now" seems like it would do the job, the "Install launcher for all users" option literally only installs the <em>launcher</em> for all users, not Python itself.)</p>
<p>Click "Next" on the "Optional Features" screen.</p>
<p>On the "Advanced Options" screen, check "Install for all users" and "Add Python to environment variables". Then click "Install".</p>
<p>For the time being, do not take advantage of the option on the final installer screen to reconfigure the machine to allow paths longer than 260 characters. We still support Windows versions that do not have this option.</p>
<h2><a class="anchor" id="autotoc_md62"></a>
PyTorch 2.1.2</h2>
<p>(This step requires a lot of memory. It failed on a machine with 12GB of RAM. It just about fitted on a 20GB machine. 32GB RAM is recommended.)</p>
<p>PyTorch requires that certain Python modules are installed. Start a command prompt "cmd.exe" using "Run as administrator". In it run:</p>
<div class="fragment"><div class="line">pip install install numpy ninja pyyaml mkl mkl-include setuptools cmake cffi typing_extensions future six requests dataclasses</div>
</div><!-- fragment --><p>This stalls part way through waiting for a key press, and it's necessary to press enter in the command prompt window to get it to complete.</p>
<p>Next, in a Git bash shell run:</p>
<div class="fragment"><div class="line">cd /c/tools</div>
<div class="line">git clone --depth=1 --branch=v2.1.2 https://github.com/pytorch/pytorch.git</div>
<div class="line">cd pytorch</div>
<div class="line">git submodule sync</div>
<div class="line">git submodule update --init --recursive</div>
</div><!-- fragment --><p>Edit <code>torch/csrc/jit/codegen/fuser/cpu/fused_kernel.cpp</code> and replace:</p>
<div class="fragment"><div class="line">std::unique_ptr&lt;FILE, decltype(&amp;_pclose)&gt; pipe(</div>
<div class="line">    _wpopen(cmd.c_str(), L&quot;r&quot;), _pclose);</div>
</div><!-- fragment --><p>with:</p>
<div class="fragment"><div class="line">std::unique_ptr&lt;FILE&gt; pipe;</div>
</div><!-- fragment --><p>Also replace:</p>
<div class="fragment"><div class="line">intptr_t r = _wspawnve(_P_WAIT, comspec, a, e.data());</div>
<div class="line">return r;</div>
</div><!-- fragment --><p>with:</p>
<div class="fragment"><div class="line">return -1;</div>
</div><!-- fragment --><p>This file is used to compile fused CPU kernels, which we do not expect to be doing and never want to do for security reasons. Replacing the calls to <code>_wpopen()</code> and <code>_wspawnve()</code> ensures that a heuristic virus scanner looking for potentially dangerous function calls in our shipped product will not encounter these functions that run external processes.</p>
<p>In <code>C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\VC\Tools\MSVC\14.29.30133\lib\x64</code> rename <code>libomp.lib</code> to <code>libomp.lib.bak</code> and rename <code>libompd.lib</code> to <code>libompd.lib.bak</code>. This is to prevent CMake's FindOpenMP module from linking to Microsoft's experimental library that we are not allowed to redistribute.</p>
<p>Start a command prompt using Start Menu -&gt; Apps -&gt; Visual Studio 2019 -&gt; x64 Native Tools Command Prompt for VS 2019, then in it type:</p>
<div class="fragment"><div class="line">cd \tools\pytorch</div>
<div class="line">set BUILD_TEST=OFF</div>
<div class="line">set BUILD_CAFFE2=OFF</div>
<div class="line">set USE_NUMPY=OFF</div>
<div class="line">set USE_DISTRIBUTED=OFF</div>
<div class="line">set USE_MKLDNN=ON</div>
<div class="line">set USE_QNNPACK=OFF</div>
<div class="line">set USE_PYTORCH_QNNPACK=OFF</div>
<div class="line">set USE_XNNPACK=OFF</div>
<div class="line">set MSVC_Z7_OVERRIDE=OFF</div>
<div class="line">set PYTORCH_BUILD_VERSION=2.1.2</div>
<div class="line">set PYTORCH_BUILD_NUMBER=1</div>
<div class="line">python setup.py install</div>
</div><!-- fragment --><p>When it completes, at the very end there is an error message that the Python modules could not be installed. This can be ignored as we only want the headers, DLLs and import libraries.</p>
<p>To finish off, in a Git bash shell run:</p>
<div class="fragment"><div class="line">cd /c/tools/pytorch</div>
<div class="line">rm -rf /c/usr/local/include/pytorch</div>
<div class="line">mkdir /c/usr/local/include/pytorch</div>
<div class="line">cp -r torch/include/* /c/usr/local/include/pytorch/</div>
<div class="line">cp torch/lib/torch_cpu.dll /c/usr/local/bin/</div>
<div class="line">cp torch/lib/torch_cpu.lib /c/usr/local/lib/</div>
<div class="line">cp torch/lib/c10.dll /c/usr/local/bin/</div>
<div class="line">cp torch/lib/c10.lib /c/usr/local/lib/</div>
<div class="line">cp torch/lib/fbgemm.dll /c/usr/local/bin/</div>
<div class="line">cp torch/lib/fbgemm.lib /c/usr/local/lib/</div>
<div class="line">cp torch/lib/asmjit.dll /c/usr/local/bin/</div>
<div class="line">cp torch/lib/asmjit.lib /c/usr/local/lib/</div>
</div><!-- fragment --><p>Finally, in <code>C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\VC\Tools\MSVC\14.29.30133\lib\x64</code> rename <code>libomp.lib.bak</code> to <code>libomp.lib</code> and rename <code>libompd.lib.bak</code> to <code>libompd.lib</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
